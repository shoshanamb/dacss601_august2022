{
  "hash": "113e7e4e62c4290c6d747d51845b4a8d",
  "result": {
    "markdown": "---\ntitle: \"Employee Absenteeism: a data Exploration for a Courier Company\"\nauthor: \"Felix Betancourt\"\ndesription: \"Discovering aspects associated to Absenteeism in a Courier company. Final Project DACSS601\"\ndate: \"08/16/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Final Project DACSS-601\n  - Organizational Development\n  - Employee turnover\n  - Absenteeism\n  - ggplot2\n  - dplyr\n  - tidyverse\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE)\n```\n:::\n\n\n# Introduction\n\nAbsenteeism is one of topics that has an economic impact in the companies. \n\nAbsenteeism takes place when employees do not report to work. Absenteeism can take two forms, authorized or unauthorized. Management is primarily interested in reducing unauthorized absenteeism since it is more likely to cause hardships on employees and guests alike (Pizam, A. & Thornburg, S. 2000).\n\nAs Henkerson and Persson (2004) said, absence from work can have multiple causes, but there is little doubt that the quantitatively most important one is sick leave. \n\nThe data available in this study is related only to the population reported absent in a courier company, therefore we will try to find what might explain the total number of hours absent to work.\n\n\n# About the Dataset:\n\nThe dataset contain real data from a Courier Company, and it was created to explain the absenteeism.\n\nVariables:\n\n1.\tIndividual identification (ID)\n2.\tReason for absence (ICD).\n\nAbsences attested by the International Code of Diseases (ICD) stratified into 21 categories (I to XXI) as follows:\n\nI Certain infectious and parasitic diseases\n\nII Neoplasms\n\nIII Diseases of the blood and blood-forming organs and certain disorders involving the immune mechanism\n\nIV Endocrine, nutritional and metabolic diseases\n\nV Mental and behavioural disorders\n\nVI Diseases of the nervous system\n\nVII Diseases of the eye and adnexa\n\nVIII Diseases of the ear and mastoid process\n\nIX Diseases of the circulatory system\n\nX Diseases of the respiratory system\n\nXI Diseases of the digestive system\n\nXII Diseases of the skin and subcutaneous tissue\n\nXIII Diseases of the musculoskeletal system and connective tissue\n\nXIV Diseases of the genitourinary system\n\nXV Pregnancy, childbirth and the puerperium\n\nXVI Certain conditions originating in the perinatal period\n\nXVII Congenital malformations, deformations and chromosomal abnormalities\n\nXVIII Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified\n\nXIX Injury, poisoning and certain other consequences of external causes\n\nXX External causes of morbidity and mortality\n\nXXI Factors influencing health status and contact with health services.\n\nAnd 7 categories without (CID) patient follow-up (22), medical consultation (23), blood donation (24), laboratory examination (25), unjustified absence (26), physiotherapy (27), dental consultation (28).\n\n3.\tMonth of absence\n4.\tDay of the week (Monday (2), Tuesday (3), Wednesday (4), Thursday (5), Friday (6))\n5.\tSeasons (summer (1), autumn (2), winter (3), spring (4))\n6.\tTransportation expense\n7.\tDistance from Residence to Work (kilometers)\n8.\tService time\n9.\tAge\n10.\tWork load Average/day\n11.\tHit target\n12.\tDisciplinary failure (yes=1; no=0)\n13.\tEducation (high school (1), graduate (2), postgraduate (3), master and doctor (4))\n14.\tSon (number of children)\n15.\tSocial Drinker (yes=1; no=0)\n16.\tSocial smoker (yes=1; no=0)\n17.\tPet (number of pet)\n18.\tWeight\n19.\tHeight\n20.\tBody mass index\n21.\tAbsenteeism time in hours (target)\n\n\n## Setting up and Reading the data\n\nLet's load packages and data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading packages\n\nsuppressPackageStartupMessages(library(dplyr))\nsuppressPackageStartupMessages(library(tidyverse))\nlibrary(formattable)\nsuppressPackageStartupMessages(library(kableExtra))\nlibrary(ggplot2)\nsuppressPackageStartupMessages(library(janitor))\n\n# Setting working directory and loading dataset.\n\nsetwd(\"/Users/fbeta/OneDrive/1-UMASS-DACSS/601/DataSets/Absenteeism/\")\n\ncourier <- read.csv(\"Absenteeism_at_work_Project.csv\")\n```\n:::\n\n\n## Exploring the data and wrangling it\n\n### Let's see the structure of the dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(courier)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t740 obs. of  21 variables:\n $ ID                       : int  11 36 3 7 11 3 10 20 14 1 ...\n $ reason_for_absence       : int  26 0 23 7 23 23 22 23 19 22 ...\n $ month_of_absence         : int  7 7 7 7 7 7 7 7 7 7 ...\n $ day_of_the_week          : int  3 3 4 5 5 6 6 6 2 2 ...\n $ seasons                  : int  1 1 1 1 1 1 1 1 1 1 ...\n $ transportation_expense   : int  289 118 179 279 289 179 NA 260 155 235 ...\n $ distance_to_work         : int  36 13 51 5 36 51 52 50 12 11 ...\n $ service_time             : int  13 18 18 14 13 18 3 11 14 14 ...\n $ age                      : int  33 50 38 39 33 38 28 36 34 37 ...\n $ work_load_average_day    : chr  \"239,554\" \"239,554\" \"239,554\" \"239,554\" ...\n $ hit_target               : int  97 97 97 97 97 97 97 97 97 97 ...\n $ disciplinary_failure     : int  0 1 0 0 0 0 0 0 0 0 ...\n $ education                : int  1 1 1 1 1 1 1 1 1 3 ...\n $ son                      : int  2 1 0 2 2 0 1 4 2 1 ...\n $ social_drinker           : int  1 1 1 1 1 1 1 1 1 0 ...\n $ social_smoker            : int  0 0 0 1 0 0 0 0 0 0 ...\n $ pet                      : int  1 0 0 0 1 0 4 0 0 1 ...\n $ weight                   : int  90 98 89 68 90 89 80 65 95 88 ...\n $ height                   : int  172 178 170 168 172 170 172 168 196 172 ...\n $ bmi                      : int  30 31 31 24 30 31 27 23 25 29 ...\n $ absenteeism_time_in_hours: int  4 0 2 4 2 NA 8 4 40 8 ...\n```\n:::\n:::\n\n\n\nThe dataset has 21 variables and 740 observations to explore potential explanations to the absenteeism.\n\nIn terms of the type of data we have:\n\n- Nine (9) Categorical variables:\n\n      - \"reason_for_absence\"\n      - \"month_of_absence\"\n      - \"day_of_the_week\"\n      - \"seasons\"    \n      - \"disciplinary_failure\"  \n      - \"education\"            \n      - \"social_drinker\"    \n      - \"social_smoker\"     \n      - \"pet\"     \n\n      \n- Three (3) numeric discrete:\n\n      - \"ID\"\n      - \"work_load_average_day\" \n      - \"hit_target\"            \n      \n- Nine (9) numeric continuous:\n\n      - \"transportation_expense\" \n      - \"distance_to_work\"      \n      - \"service_time\"         \n      - \"age\"                 \n      - \"son\"                \n      - \"weight\"            \n      - \"height\"            \n      - \"bmi\"               \n      - \"absenteeism_time_in_hours\"\n\n      \nThe dataset seems very clean in general, but I will adjust a few things:\n\n1. Variable \"work_load_average_day\" and \"hit_target\" are not clear in the description of the file. Also \"pet\" and \"month_of_absence\" (we have season) does not seem relevant variable. I rather to eliminate those variables from the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncourier2 <- courier %>%\n  dplyr::select(-work_load_average_day, -hit_target, -pet, -month_of_absence)\n```\n:::\n\n\n2. On the other hand weight and height are used to calculate BMI, so I will eliminate also those 2 variables to simplify the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncourier2 <- courier2 %>%\n  dplyr::select(-weight, -height)\n```\n:::\n\n\n3. I will re code back to the categories name for a few relevant categorical variables to use it as character in tables, and will create categorical type of variable for Son (number of children) and ID. But I'll save it as new variables in case I need to use it as numeric too at some point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncourier2 <-courier2%>%\n  mutate(Reason = case_when(\n        reason_for_absence == 1 ~ \"Parasitic\",\n        reason_for_absence == 2 ~ \"Neoplasms\",\n        reason_for_absence == 3 ~ \"Blood and Immune\",\n        reason_for_absence == 4 ~ \"Metabolic\",\n        reason_for_absence == 5 ~ \"Mental\",\n        reason_for_absence == 6 ~ \"Nervous system\",\n        reason_for_absence == 7 ~ \"Eye and Adnexa\",\n        reason_for_absence == 8 ~ \"Ear and Mastoid\",\n        reason_for_absence == 9 ~ \"Circulatory\",\n        reason_for_absence == 10 ~ \"Respiratory\",\n        reason_for_absence == 11 ~ \"Digestive\",\n        reason_for_absence == 12 ~ \"Skin\",\n        reason_for_absence == 13 ~ \"Musculoskeletal\",\n        reason_for_absence == 14 ~ \"Genitourinary\",\n        reason_for_absence == 15 ~ \"Pregnancy\",\n        reason_for_absence == 16 ~ \"Perinatal period\",\n        reason_for_absence == 17 ~ \"Deformations and Chromosomal\",\n        reason_for_absence == 18 ~ \"Laboratory findings\",\n        reason_for_absence == 19 ~ \"Injury, Poisoning\",\n        reason_for_absence == 20 ~ \"External causes and mortality\",\n        reason_for_absence == 21 ~ \"Health status\",\n        )) %>%\n  mutate(Education.Level = case_when(\n         education == 1 ~ \"High School\",\n         education == 2 ~ \"Bachelor\",\n         education == 3 ~ \"Post-graduate\",\n         education == 4 ~ \"Master or Phd\",\n         )) %>%\n  mutate(Day.of.Week = case_when(\n         day_of_the_week == 2 ~ \"Monday\",\n         day_of_the_week == 3 ~ \"Tuesday\",\n         day_of_the_week == 4 ~ \"Wednesday\",\n         day_of_the_week == 5 ~ \"Thursday\",\n         day_of_the_week == 6 ~ \"Friday\",\n         ))%>%\n  mutate(Season = case_when(\n         seasons == 1 ~ \"Summer\",\n         seasons == 2 ~ \"Fall\",\n         seasons == 3 ~ \"Winter\",\n         seasons == 4 ~ \"Spring\",\n         ))%>%\n  mutate(Disciplined = case_when(\n         disciplinary_failure == 1 ~ \"Yes\",\n         disciplinary_failure == 0 ~ \"No\",\n         ))%>%\n  mutate(Drinker = case_when(\n         social_drinker == 1 ~ \"Yes\",\n         social_drinker == 0 ~ \"No\",\n        ))%>%\n  mutate(Children = case_when(\n         son == 0 ~ \"No Children\",\n         son == 1 ~ \"One\",\n         son == 2 ~ \"Two\",\n         son == 3 ~ \"Three\",\n         son == 4 ~ \"Four\",\n        ))%>%\n  mutate(Smoker = case_when(\n         social_smoker == 1 ~ \"Yes\",\n         social_smoker == 0 ~ \"No\",\n         ))\n\ncourier2$ID <- sub(\"^\", \"EE\", courier$ID )\n```\n:::\n\n\nLet's check the new Dimensions of the dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim.data.frame(courier2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 740  23\n```\n:::\n:::\n\nNow we have 23 variables (including the new re-coded ones) in the dataset and 740 cases/rows.\n\nIn addition, probably we have several observations for each employee in different rows (one entry for each absence in the same employee). Let's check how many distinct employees we have in the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncourier3 <- courier2 %>%\n  filter(!is.na(ID) & ID != \"NULL\") %>%\n  group_by(ID) %>%\n  tally(sort = T) %>%\n  arrange(desc(n))\ncourier3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 36 × 2\n   ID        n\n   <chr> <int>\n 1 EE3     113\n 2 EE28     76\n 3 EE34     55\n 4 EE22     46\n 5 EE20     42\n 6 EE11     40\n 7 EE15     37\n 8 EE36     34\n 9 EE24     30\n10 EE14     29\n# … with 26 more rows\n```\n:::\n:::\n\n\nCertainly we have only 36 unique employees reported absent to work at least 1 time.\n\n\nNow let's see a summary of total hours of absence for each unique Employee:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(data.table))\ndt <- data.table(courier2)\ndt2 <- dt[,list(Total.Hours = sum(absenteeism_time_in_hours, na.rm=T), freq = .N), by = c(\"ID\", \"Reason\")]\n\n  ID_table <- dt2 %>% \n  group_by(ID) %>%\n  summarise(Total.Hours.r = sum(Total.Hours, na.rm=TRUE), Hours.Mean = mean(Total.Hours, na.rm=TRUE), Hours.Median = median(Total.Hours, na.rm=TRUE))\nID_table <- ID_table %>%\n  mutate(Total.Hours.Percent = Total.Hours.r/(sum(Total.Hours.r))*100.2)\n  ID_table <- ID_table[with (ID_table, order(-Total.Hours.Percent)),]\n\nID_table <- ID_table%>%\n  mutate(Cum_Percent = cumsum(Total.Hours.Percent))\n  \nID_table_o <- ID_table[with (ID_table, order(-Total.Hours.Percent)),]\nformattable(ID_table_o) %>% \n  kable(\"html\", escape = F, caption = \"Summary of Total Hours Absent by Employee\", align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\")) %>% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Summary of Total Hours Absent by Employee</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:center;\"> Total.Hours.r </th>\n   <th style=\"text-align:center;\"> Hours.Mean </th>\n   <th style=\"text-align:center;\"> Hours.Median </th>\n   <th style=\"text-align:center;\"> Total.Hours.Percent </th>\n   <th style=\"text-align:center;\"> Cum_Percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> EE11 </td>\n   <td style=\"text-align:center;\"> 450 </td>\n   <td style=\"text-align:center;\"> 64.285714 </td>\n   <td style=\"text-align:center;\"> 24.0 </td>\n   <td style=\"text-align:center;\"> 9.00 </td>\n   <td style=\"text-align:center;\"> 9.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE3 </td>\n   <td style=\"text-align:center;\"> 448 </td>\n   <td style=\"text-align:center;\"> 49.777778 </td>\n   <td style=\"text-align:center;\"> 12.0 </td>\n   <td style=\"text-align:center;\"> 8.96 </td>\n   <td style=\"text-align:center;\"> 17.96 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE14 </td>\n   <td style=\"text-align:center;\"> 356 </td>\n   <td style=\"text-align:center;\"> 39.555556 </td>\n   <td style=\"text-align:center;\"> 32.0 </td>\n   <td style=\"text-align:center;\"> 7.12 </td>\n   <td style=\"text-align:center;\"> 25.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE28 </td>\n   <td style=\"text-align:center;\"> 345 </td>\n   <td style=\"text-align:center;\"> 31.363636 </td>\n   <td style=\"text-align:center;\"> 15.0 </td>\n   <td style=\"text-align:center;\"> 6.90 </td>\n   <td style=\"text-align:center;\"> 31.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE34 </td>\n   <td style=\"text-align:center;\"> 341 </td>\n   <td style=\"text-align:center;\"> 34.100000 </td>\n   <td style=\"text-align:center;\"> 10.5 </td>\n   <td style=\"text-align:center;\"> 6.82 </td>\n   <td style=\"text-align:center;\"> 38.80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE36 </td>\n   <td style=\"text-align:center;\"> 311 </td>\n   <td style=\"text-align:center;\"> 51.833333 </td>\n   <td style=\"text-align:center;\"> 16.5 </td>\n   <td style=\"text-align:center;\"> 6.22 </td>\n   <td style=\"text-align:center;\"> 45.02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE20 </td>\n   <td style=\"text-align:center;\"> 295 </td>\n   <td style=\"text-align:center;\"> 42.142857 </td>\n   <td style=\"text-align:center;\"> 16.0 </td>\n   <td style=\"text-align:center;\"> 5.90 </td>\n   <td style=\"text-align:center;\"> 50.92 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE9 </td>\n   <td style=\"text-align:center;\"> 262 </td>\n   <td style=\"text-align:center;\"> 52.400000 </td>\n   <td style=\"text-align:center;\"> 16.0 </td>\n   <td style=\"text-align:center;\"> 5.24 </td>\n   <td style=\"text-align:center;\"> 56.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE15 </td>\n   <td style=\"text-align:center;\"> 253 </td>\n   <td style=\"text-align:center;\"> 42.166667 </td>\n   <td style=\"text-align:center;\"> 40.0 </td>\n   <td style=\"text-align:center;\"> 5.06 </td>\n   <td style=\"text-align:center;\"> 61.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE22 </td>\n   <td style=\"text-align:center;\"> 253 </td>\n   <td style=\"text-align:center;\"> 36.142857 </td>\n   <td style=\"text-align:center;\"> 39.0 </td>\n   <td style=\"text-align:center;\"> 5.06 </td>\n   <td style=\"text-align:center;\"> 66.28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE24 </td>\n   <td style=\"text-align:center;\"> 238 </td>\n   <td style=\"text-align:center;\"> 29.750000 </td>\n   <td style=\"text-align:center;\"> 35.0 </td>\n   <td style=\"text-align:center;\"> 4.76 </td>\n   <td style=\"text-align:center;\"> 71.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE13 </td>\n   <td style=\"text-align:center;\"> 175 </td>\n   <td style=\"text-align:center;\"> 43.750000 </td>\n   <td style=\"text-align:center;\"> 35.5 </td>\n   <td style=\"text-align:center;\"> 3.50 </td>\n   <td style=\"text-align:center;\"> 74.54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE10 </td>\n   <td style=\"text-align:center;\"> 170 </td>\n   <td style=\"text-align:center;\"> 24.285714 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 3.40 </td>\n   <td style=\"text-align:center;\"> 77.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE7 </td>\n   <td style=\"text-align:center;\"> 150 </td>\n   <td style=\"text-align:center;\"> 50.000000 </td>\n   <td style=\"text-align:center;\"> 24.0 </td>\n   <td style=\"text-align:center;\"> 3.00 </td>\n   <td style=\"text-align:center;\"> 80.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE17 </td>\n   <td style=\"text-align:center;\"> 126 </td>\n   <td style=\"text-align:center;\"> 15.750000 </td>\n   <td style=\"text-align:center;\"> 9.5 </td>\n   <td style=\"text-align:center;\"> 2.52 </td>\n   <td style=\"text-align:center;\"> 83.46 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE1 </td>\n   <td style=\"text-align:center;\"> 121 </td>\n   <td style=\"text-align:center;\"> 13.444444 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 2.42 </td>\n   <td style=\"text-align:center;\"> 85.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE18 </td>\n   <td style=\"text-align:center;\"> 110 </td>\n   <td style=\"text-align:center;\"> 15.714286 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 2.20 </td>\n   <td style=\"text-align:center;\"> 88.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE5 </td>\n   <td style=\"text-align:center;\"> 104 </td>\n   <td style=\"text-align:center;\"> 34.666667 </td>\n   <td style=\"text-align:center;\"> 24.0 </td>\n   <td style=\"text-align:center;\"> 2.08 </td>\n   <td style=\"text-align:center;\"> 90.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE26 </td>\n   <td style=\"text-align:center;\"> 83 </td>\n   <td style=\"text-align:center;\"> 16.600000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 1.66 </td>\n   <td style=\"text-align:center;\"> 91.82 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE33 </td>\n   <td style=\"text-align:center;\"> 73 </td>\n   <td style=\"text-align:center;\"> 12.166667 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 1.46 </td>\n   <td style=\"text-align:center;\"> 93.28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE6 </td>\n   <td style=\"text-align:center;\"> 72 </td>\n   <td style=\"text-align:center;\"> 18.000000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 1.44 </td>\n   <td style=\"text-align:center;\"> 94.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE25 </td>\n   <td style=\"text-align:center;\"> 42 </td>\n   <td style=\"text-align:center;\"> 7.000000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.84 </td>\n   <td style=\"text-align:center;\"> 95.56 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE12 </td>\n   <td style=\"text-align:center;\"> 34 </td>\n   <td style=\"text-align:center;\"> 8.500000 </td>\n   <td style=\"text-align:center;\"> 9.5 </td>\n   <td style=\"text-align:center;\"> 0.68 </td>\n   <td style=\"text-align:center;\"> 96.24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE23 </td>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:center;\"> 10.666667 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.64 </td>\n   <td style=\"text-align:center;\"> 96.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE30 </td>\n   <td style=\"text-align:center;\"> 31 </td>\n   <td style=\"text-align:center;\"> 10.333333 </td>\n   <td style=\"text-align:center;\"> 9.0 </td>\n   <td style=\"text-align:center;\"> 0.62 </td>\n   <td style=\"text-align:center;\"> 97.50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE2 </td>\n   <td style=\"text-align:center;\"> 25 </td>\n   <td style=\"text-align:center;\"> 12.500000 </td>\n   <td style=\"text-align:center;\"> 12.5 </td>\n   <td style=\"text-align:center;\"> 0.50 </td>\n   <td style=\"text-align:center;\"> 98.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE29 </td>\n   <td style=\"text-align:center;\"> 21 </td>\n   <td style=\"text-align:center;\"> 7.000000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.42 </td>\n   <td style=\"text-align:center;\"> 98.42 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE27 </td>\n   <td style=\"text-align:center;\"> 19 </td>\n   <td style=\"text-align:center;\"> 6.333333 </td>\n   <td style=\"text-align:center;\"> 4.0 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 98.80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE16 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 8.000000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 99.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE21 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 5.333333 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 99.44 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE31 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 5.333333 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 99.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE32 </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 4.000000 </td>\n   <td style=\"text-align:center;\"> 3.5 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 100.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE19 </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 3.000000 </td>\n   <td style=\"text-align:center;\"> 3.0 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 100.20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE35 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0.000000 </td>\n   <td style=\"text-align:center;\"> 0.0 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 100.20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE4 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0.000000 </td>\n   <td style=\"text-align:center;\"> 0.0 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 100.20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EE8 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0.000000 </td>\n   <td style=\"text-align:center;\"> 0.0 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 100.20 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\nIt does seems interesting that 50% of the total hours of absence are concentrated in 7 employees only (EE11, EE3, EE14, EE28, EE34, EE36, EE20).\n\nAs most of the bibliography indicate, the most frequent reason for absence is medical reasons. So we will put some focus on the reasons of absence.\n\nFirst let's visualize Reasons for absence.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbox_plot_crop<-ggplot(data=courier2, aes(Reason,absenteeism_time_in_hours, fill=Reason)) \nbox_plot_crop+ geom_boxplot(alpha=0.7, outlier.shape = NA) +\n  theme(legend.position = \"right\") +\n  theme (axis.text.x=element_blank(),\n        axis.ticks.x=element_blank())+\n  coord_cartesian(ylim =  c(0, 60))+\n  labs(title=\"Total Absenteeism Hours by Reason of Absence\",\n        x =\"Reason of Absence\", y = \"Total Hours\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nClearly some reasons (Circulatory, Injury-Poisoning, Musculoeskeletal and Skin) represent more absence hours than others.\n\n2. Let's summarize this variable on a table to see it more clearly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n ID_table2 <- dt2 %>% \n  group_by(Reason) %>%\n  summarise(Total.Hours.r = sum(Total.Hours, na.rm=TRUE), Hours.Mean = mean(Total.Hours, na.rm=TRUE), Hours.Median = median(Total.Hours, na.rm=TRUE))\nID_table2 <- ID_table2 %>%\n  mutate(Total.Hours.Percent = Total.Hours.r/(sum(Total.Hours.r))*100.2)\n  ID_table2 <- ID_table2[with (ID_table2, order(-Total.Hours.Percent)),]\n\nID_table2 <- ID_table2%>%\n  mutate(Cum_Percent = cumsum(Total.Hours.Percent))\n  \nID_table_o2 <- ID_table2[with (ID_table2, order(-Total.Hours.Percent)),]\nformattable(ID_table_o2) %>% \n  kable(\"html\", escape = F, caption = \"Summary of Total Hours Absent by Reason\", align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\")) %>% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Summary of Total Hours Absent by Reason</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Reason </th>\n   <th style=\"text-align:center;\"> Total.Hours.r </th>\n   <th style=\"text-align:center;\"> Hours.Mean </th>\n   <th style=\"text-align:center;\"> Hours.Median </th>\n   <th style=\"text-align:center;\"> Total.Hours.Percent </th>\n   <th style=\"text-align:center;\"> Cum_Percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:center;\"> 1651 </td>\n   <td style=\"text-align:center;\"> 45.861111 </td>\n   <td style=\"text-align:center;\"> 29.0 </td>\n   <td style=\"text-align:center;\"> 33.02 </td>\n   <td style=\"text-align:center;\"> 33.02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Musculoskeletal </td>\n   <td style=\"text-align:center;\"> 810 </td>\n   <td style=\"text-align:center;\"> 45.000000 </td>\n   <td style=\"text-align:center;\"> 35.5 </td>\n   <td style=\"text-align:center;\"> 16.20 </td>\n   <td style=\"text-align:center;\"> 49.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Injury, Poisoning </td>\n   <td style=\"text-align:center;\"> 729 </td>\n   <td style=\"text-align:center;\"> 42.882353 </td>\n   <td style=\"text-align:center;\"> 16.0 </td>\n   <td style=\"text-align:center;\"> 14.58 </td>\n   <td style=\"text-align:center;\"> 63.80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Respiratory </td>\n   <td style=\"text-align:center;\"> 260 </td>\n   <td style=\"text-align:center;\"> 20.000000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 5.20 </td>\n   <td style=\"text-align:center;\"> 69.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Laboratory findings </td>\n   <td style=\"text-align:center;\"> 217 </td>\n   <td style=\"text-align:center;\"> 18.083333 </td>\n   <td style=\"text-align:center;\"> 12.0 </td>\n   <td style=\"text-align:center;\"> 4.34 </td>\n   <td style=\"text-align:center;\"> 73.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Skin </td>\n   <td style=\"text-align:center;\"> 187 </td>\n   <td style=\"text-align:center;\"> 26.714286 </td>\n   <td style=\"text-align:center;\"> 4.0 </td>\n   <td style=\"text-align:center;\"> 3.74 </td>\n   <td style=\"text-align:center;\"> 77.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Parasitic </td>\n   <td style=\"text-align:center;\"> 182 </td>\n   <td style=\"text-align:center;\"> 15.166667 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 3.64 </td>\n   <td style=\"text-align:center;\"> 80.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Digestive </td>\n   <td style=\"text-align:center;\"> 177 </td>\n   <td style=\"text-align:center;\"> 12.642857 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 3.54 </td>\n   <td style=\"text-align:center;\"> 84.26 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Circulatory </td>\n   <td style=\"text-align:center;\"> 168 </td>\n   <td style=\"text-align:center;\"> 56.000000 </td>\n   <td style=\"text-align:center;\"> 48.0 </td>\n   <td style=\"text-align:center;\"> 3.36 </td>\n   <td style=\"text-align:center;\"> 87.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Nervous system </td>\n   <td style=\"text-align:center;\"> 163 </td>\n   <td style=\"text-align:center;\"> 23.285714 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 3.26 </td>\n   <td style=\"text-align:center;\"> 90.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Genitourinary </td>\n   <td style=\"text-align:center;\"> 159 </td>\n   <td style=\"text-align:center;\"> 13.250000 </td>\n   <td style=\"text-align:center;\"> 6.5 </td>\n   <td style=\"text-align:center;\"> 3.18 </td>\n   <td style=\"text-align:center;\"> 94.06 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Eye and Adnexa </td>\n   <td style=\"text-align:center;\"> 150 </td>\n   <td style=\"text-align:center;\"> 12.500000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 3.00 </td>\n   <td style=\"text-align:center;\"> 97.06 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Health status </td>\n   <td style=\"text-align:center;\"> 35 </td>\n   <td style=\"text-align:center;\"> 8.750000 </td>\n   <td style=\"text-align:center;\"> 8.5 </td>\n   <td style=\"text-align:center;\"> 0.70 </td>\n   <td style=\"text-align:center;\"> 97.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ear and Mastoid </td>\n   <td style=\"text-align:center;\"> 32 </td>\n   <td style=\"text-align:center;\"> 10.666667 </td>\n   <td style=\"text-align:center;\"> 11.0 </td>\n   <td style=\"text-align:center;\"> 0.64 </td>\n   <td style=\"text-align:center;\"> 98.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Neoplasms </td>\n   <td style=\"text-align:center;\"> 24 </td>\n   <td style=\"text-align:center;\"> 24.000000 </td>\n   <td style=\"text-align:center;\"> 24.0 </td>\n   <td style=\"text-align:center;\"> 0.48 </td>\n   <td style=\"text-align:center;\"> 98.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mental </td>\n   <td style=\"text-align:center;\"> 19 </td>\n   <td style=\"text-align:center;\"> 6.333333 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 99.26 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Pregnancy </td>\n   <td style=\"text-align:center;\"> 16 </td>\n   <td style=\"text-align:center;\"> 8.000000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.32 </td>\n   <td style=\"text-align:center;\"> 99.58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Metabolic </td>\n   <td style=\"text-align:center;\"> 9 </td>\n   <td style=\"text-align:center;\"> 4.500000 </td>\n   <td style=\"text-align:center;\"> 4.5 </td>\n   <td style=\"text-align:center;\"> 0.18 </td>\n   <td style=\"text-align:center;\"> 99.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Blood and Immune </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 8.000000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 99.92 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Deformations and Chromosomal </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 8.000000 </td>\n   <td style=\"text-align:center;\"> 8.0 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 100.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Perinatal period </td>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 3.000000 </td>\n   <td style=\"text-align:center;\"> 3.0 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 100.20 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n      \nWe can notice that 1/3 of the hours absent does not report a reason or not reported what was the medical reason.\n\nThen, we found that the following medical reasons concentrate about 55% (by resting the 33% NA to the 88% cumulated ) of the total hours absent:\n\nMusculoskeletal\n\nInjury, Poisoning\n\nRespiratory\n\nLaboratory findings\t\n\nSkin\t\n\nParasitic\t\n\nDigestive\t\n\nCirculatory \n\nIt is relevant to mention that Circulatory followed by Musculoskeletal conditions tends to produce, in average, more hours of absence.\n\nNow let's try to analyze the data by discriminating better between Medical Reasons and specific employees or group of employees with more absence by separating those variables in 2 groups.\n\nLet's create two new columns with 2 new groups each: high and low \"risk\", where the observations corresponding to those seven high absent employees will be categorized as \"High Absence\" and the rest (29 employees) as \"Low Absence\". And Medical Reason as High Risk or Low Risk, where the conditions listed above will conform the group of \"Medical High Risk\" and the rest \"Medical Low Risk\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncourier2 <- courier2%>%\n  mutate(Risk = case_when(\n        ID == 'EE11' ~ \"High Absence\",\n        ID == 'EE3' ~ \"High Absence\",\n        ID == 'EE14' ~ \"High Absence\",\n        ID == 'EE28' ~ \"High Absence\",\n        ID == 'EE34' ~ \"High Absence\",\n        ID == 'EE36' ~ \"High Absence\",\n        ID == 'EE20' ~ \"High Absence\",\n        TRUE ~ \"Low Absence\"\n        ))%>%\n  mutate(Reason.Group = case_when(\n        Reason == 'Musculoskeletal' ~ \"Medical High Risk\",\n        Reason == 'Injury, Poisoning' ~ \"Medical High Risk\",\n        Reason == 'Respiratory' ~ \"Medical High Risk\",\n        Reason == 'Laboratory findings' ~ \"Medical High Risk\",\n        Reason == 'Skin' ~ \"Medical High Risk\",\n        Reason == 'Parasitic' ~ \"Medical High Risk\",\n        Reason == 'Digestive' ~ \"Medical High Risk\",\n        Reason == 'Circulatory' ~ \"Medical High Risk\",\n        TRUE ~ \"Medical Low Risk\"\n        ))\n```\n:::\n\n\n\n### Let's visualize and summarize other categorical variables grouped by Medical Reason and Risk group. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(epiDisplay)) #Using epiDisplay package to get useful tables with frequency and percentages\n\n# Box Plot - Education Level\ncourier2$Education.Level <- factor(courier2$Education.Level , levels=c(\"High School\", \"Bachelor\", \"Master or Phd\", \"Post-graduate\", \"NA\"))\nggplot(courier2, aes(x = Education.Level, y = absenteeism_time_in_hours, fill = Risk))+\n  geom_boxplot(alpha=0.7, outlier.shape = NA)+\n  facet_wrap(.~Reason.Group, scales = \"free\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  theme(legend.position = \"right\") +\n  coord_cartesian(ylim =  c(0, 26))+\n  labs(title=\"Total Absenteeism Hours by Education Level\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Education Level\", y = \"Total Hours\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Frequency table for Education Level\ntab1(courier2$Education.Level, sort.group = \"decreasing\", cum.percent = F, missing = FALSE, graph = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncourier2$Education.Level : \n              Frequency   %(NA+)   %(NA-)\nHigh School         601     81.2     82.3\nPost-graduate        79     10.7     10.8\nBachelor             46      6.2      6.3\nNA's                 10      1.4      0.0\nMaster or Phd         4      0.5      0.5\nNA                    0      0.0      0.0\n  Total             740    100.0    100.0\n```\n:::\n:::\n\n\nHere we can notice that, High School represent 80% of the observations, and the High Absent and High Medical Risk groups are more represented in this level of education. Probably most of the absent are in non-professional roles within the company.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box Plot - Day of the week\ncourier2$Day.of.Week <- factor(courier2$Day.of.Week , levels=c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\"))\nggplot(courier2, aes(x = Day.of.Week, y = absenteeism_time_in_hours, fill = Risk))+\n  geom_boxplot(alpha=0.7, outlier.shape = NA)+\n  facet_wrap(.~Reason.Group, scales = \"free\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  theme(legend.position = \"right\") +\n  coord_cartesian(ylim =  c(0, 26))+\n  labs(title=\"Total Absenteeism Hours by Day of the Week\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Day of the Week\", y = \"Total Hours\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Frequency table for Day of the Week\ntab1(courier2$Day.of.Week, sort.group = \"decreasing\", cum.percent = F, missing = FALSE, graph = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncourier2$Day.of.Week : \n          Frequency Percent\nMonday          161    21.8\nWednesday       156    21.1\nTuesday         154    20.8\nFriday          144    19.5\nThursday        125    16.9\n  Total         740   100.0\n```\n:::\n:::\n\n\nHere we can note that the High Absent group is almost evenly distributed during the week, though Wednesday seems a more prevalent day in the week.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box Plot -Season\ncourier2$Season <- factor(courier2$Season , levels=c(\"Winter\", \"Spring\", \"Summer\", \"Fall\"))\nggplot(courier2, aes(x = Season, y = absenteeism_time_in_hours, fill = Risk))+\n  geom_boxplot(alpha=0.7, outlier.shape = NA)+\n  facet_wrap(.~Reason.Group, scales = \"free\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  theme(legend.position = \"right\") +\n  coord_cartesian(ylim =  c(0, 26))+\n  labs(title=\"Total Absenteeism Hours by Season\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Season\", y = \"Total Hours\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Frequency table for Season\ntab1(courier2$Season, sort.group = \"decreasing\", cum.percent = F, missing = FALSE, graph = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncourier2$Season : \n        Frequency Percent\nSpring        195    26.4\nFall          192    25.9\nWinter        183    24.7\nSummer        170    23.0\n  Total       740   100.0\n```\n:::\n:::\n\nIt seems that for the High Absent group of employees with Medical High Risk, Winter and Spring are the most prevalent Seasons of the year to be absent.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box Plot Disciplined\n\nggplot(courier2, aes(x = Disciplined, y = absenteeism_time_in_hours, fill = Risk))+\n  geom_boxplot(alpha=0.7, outlier.shape = NA)+\n  facet_wrap(.~Reason.Group, scales = \"free\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  theme(legend.position = \"right\") +\n  coord_cartesian(ylim =  c(0, 26))+\n  labs(title=\"Total Absenteeism Hours by Disciplined\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Disciplined\", y = \"Total Hours\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Frequency table for Disciplined or not\ntab1(courier2$Disciplined, sort.group = \"decreasing\", cum.percent = F, missing = FALSE, graph = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncourier2$Disciplined : \n        Frequency   %(NA+)   %(NA-)\nNo            695     93.9     94.7\nYes            39      5.3      5.3\n<NA>            6      0.8      0.0\n  Total       740    100.0    100.0\n```\n:::\n:::\n\n\nIt looks that not being Disciplined is related to more hours absent, but at the same time if we look at the frequency table, 94% of the observations does not show a record of being Disciplined before. Therefore we can't make a conclusion with this variable.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box Plot - Drinker\nggplot(courier2, aes(x = Drinker, y = absenteeism_time_in_hours, fill = Risk))+\n  geom_boxplot(alpha=0.7, outlier.shape = NA)+\n  facet_wrap(.~Reason.Group, scales = \"free\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  theme(legend.position = \"right\") +\n  coord_cartesian(ylim =  c(0, 26))+\n  labs(title=\"Total Absenteeism Hours by Drinker\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Drinker\", y = \"Total Hours\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Frequency table for Drinker or not\n\ntab1(courier2$Drinker, sort.group = \"decreasing\", cum.percent = F, missing = FALSE, graph = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncourier2$Drinker : \n        Frequency   %(NA+)   %(NA-)\nYes           418     56.5     56.7\nNo            319     43.1     43.3\n<NA>            3      0.4      0.0\n  Total       740    100.0    100.0\n```\n:::\n:::\n\n\nIn this case, for the Medical High Risk group, it seems that being reported as a Drinker is associated to have more hours absent in general. So, there could be a relation between being Social Drinker, certain Medical conditions and being absent at work.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box Plot Smoker\n\nggplot(courier2, aes(x = Smoker, y = absenteeism_time_in_hours, fill = Risk))+\n  geom_boxplot(alpha=0.7, outlier.shape = NA)+\n  facet_wrap(.~Reason.Group, scales = \"free\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  theme(legend.position = \"right\") +\n  coord_cartesian(ylim =  c(0, 26))+\n  labs(title=\"Total Absenteeism Hours by Smoker\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Smoker\", y = \"Total Hours\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Frequency table for Smoker or not\ntab1(courier2$Smoker, sort.group = \"decreasing\", cum.percent = F, missing = FALSE, graph = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncourier2$Smoker : \n        Frequency   %(NA+)   %(NA-)\nNo            682     92.2     92.7\nYes            54      7.3      7.3\n<NA>            4      0.5      0.0\n  Total       740    100.0    100.0\n```\n:::\n:::\n\n\nSeems that being Smoker does not represent a Risk of absence, but at the same time we need to consider that 92% of the employees in this dataset are not Smoker. Also it is interesting to see that only 4 observations did not report whether Smoker or not, but they represent an important amount of hours absent.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Box Plot - Children\ncourier2$Children <- factor(courier2$Children , levels=c(\"No Children\", \"One\", \"Two\", \"Three\", \"Four\", \"NA\"))\nggplot(courier2, aes(x = Children, y = absenteeism_time_in_hours, fill = Risk))+\n  geom_boxplot(alpha=0.7, outlier.shape = NA)+\n  facet_wrap(.~Reason.Group, scales = \"free\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  theme(legend.position = \"right\") +\n  coord_cartesian(ylim =  c(0, 26))+\n  labs(title=\"Total Absenteeism Hours by Children\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Children\", y = \"Total Hours\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Frequency table for Number of Children\ntab1(courier2$Children, sort.group = \"decreasing\", cum.percent = F, missing = FALSE, graph = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncourier2$Children : \n            Frequency   %(NA+)   %(NA-)\nNo Children       295     39.9     40.2\nOne               228     30.8     31.1\nTwo               155     20.9     21.1\nFour               41      5.5      5.6\nThree              15      2.0      2.0\nNA's                6      0.8      0.0\nNA                  0      0.0      0.0\n  Total           740    100.0    100.0\n```\n:::\n:::\n\n\n\nAs we can note above, in the case of number of Children, it seems that regardless the Medical Risk, having 2 or more kids may have and prevalent incidence the absenteeism.\n\nWhile this is clear in the visualization, it is a bit difficult to make a conclusion or take further actions based on this finding, other than offering options and be more flexible for the employees to take care of their family.\n\n\n## Now let's check any relation between Total Hours of Absence and other continuos variables.\n\n### Let's use Scatter Plots to visualize.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tenure\n\nscatter1 <- ggplot(courier2, aes(service_time,absenteeism_time_in_hours, col=Risk))+\n  geom_point()+\n  scale_y_continuous(limits=c(0,150))+\n  labs(title=\"Total Absenteeism Hours vs Tenure\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Years of Service\", y = \"Total Hours\")\nscatter1+\n  facet_wrap(vars(Reason.Group))\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Age\n\nscatter2 <- ggplot(courier2, aes(age,absenteeism_time_in_hours, col=Risk))+\n  geom_point()+\n  scale_y_continuous(limits=c(0,100))+\n  labs(title=\"Total Absenteeism Hours vs Age\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Age\", y = \"Total Hours\")\nscatter2+\n  facet_wrap(vars(Reason.Group))\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#BMI\n\nscatter3 <- ggplot(courier2, aes(bmi,absenteeism_time_in_hours, col=Risk))+\n  geom_point()+\n  scale_y_continuous(limits=c(0,100))+\n  labs(title=\"Total Absenteeism Hours vs BMI\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Body Mass Index\", y = \"Total Hours\")\nscatter3+\n  facet_wrap(vars(Reason.Group))\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Distance to Work \n\nscatter5 <- ggplot(courier2, aes(distance_to_work,absenteeism_time_in_hours, col=Risk))+\n  geom_point()+\n  scale_y_continuous(limits=c(0,100))+\n  labs(title=\"Total Absenteeism Hours vs Distance to work\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Distance to work in KM\", y = \"Total Hours\")\nscatter5+\n  facet_wrap(vars(Reason.Group))\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Transportation Expenses \n\nscatter6 <- ggplot(courier2, aes(transportation_expense,absenteeism_time_in_hours, col=Risk))+\n  geom_point()+\n  scale_y_continuous(limits=c(0,100))+\n  labs(title=\"Total Absenteeism Hours vs Transportation Expense\",\n       subtitle = \"Grouped by Medical Reason Group and Risk of Absence\",\n        x =\"Transportation Expense\", y = \"Total Hours\")\nscatter6+\n  facet_wrap(vars(Reason.Group))\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_FinalProject601vFinal_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n\nIn general, there is not a clear pattern that we can identify from these scatter plots, however it is interesting to see how in the High Absence group with High medical conditions live relatively close to work (about 10 Km), though difficult to make a relevant conclusion from there.\n\n## Conclusions\n\nThe first conclusion is that in this company in particular 50% of the total hours of absence are concentrated in 7 employees out of the 36 in the dataset. \n\nAlso, it is relevant to note that 33% of the absence records does not report an specific reason for the absence or it is not related to medical conditions. Which open questions around employee engagement.\n\nOn the other hand 55% of the total hours absent are concentrated to 8 medical (Musculoskeletal, Injury-Poisoning, Respiratory, Laboratory findings, Skin, Parasitic, \nDigestive, Circulatory) conditions out of the 21 identified in the observations. And Circulatory and Musculoskeletal conditions tend to produce more hours of absence.\n\nBeing Social Drinker seems associated with the medical conditions that produce more hours of absence, so Drinking should be a variable to consider in the action plan.\n\nIn terms os seasonality, seems that there are more prevalence of being absent during Winter and Spring, specifically for the high Medical Risk group.\n\nThe most absent population seems to be in the non-professional roles based on the prevalence of Education Level.\n\nLastly, regardless the Medical Risk, having 2 to 4 children seems associated to more hours absent in general. So this is a topic, the company should dig more to offer support to employees with kids.\n\n#### Recommendations\n\nBased on these conclusions, there are some actions recommended that we can define to reduce the absence hours, here some suggestions:\n\n1. Deploy wellness campaigns focusing on:\n\n- Physical activities and healthy diet to have a positive impact on Circulatory conditions.\n\n- Implement a cmpaign to estimulate active pauses and stretching to prevent musculoskeletal illness. This might include physical therapy excersices.\n\n- Explain the influence of drinking alcohol in the Health in general. \n\nThese campaigns should be more intense in Winter and Spring.\n\n2. Define and deploy a paid time off oriented to care givers in the need of taking care of their Children.\n\n\n## Reflection\n\nThis project was challenging mostly due to lack of public data related to companies/employees, I found several fake dataset, but not too much real data.\n\nThen, and related to the above, the datasets related to employees does not contain very relevant information like salary/wages. This is a very sensitive information and the same time critical to analyze patterns.\n\nOn the other hand I learned from this dataset and based on my own experience in Organizational environments that employee's data in general are heavy in categorical type of data. So it require the use of a lot of tables and it is challenging to explore the data with visualization.\n\nOn the technical (R) side, I learned that there are multiple ways to work with the data, many packages, sometimes conflict between packages, etc. There is a lot to learn with R.\n\nAt the beginning this course, I was wondering why not using traditional statistics packages (SPSS, etc), and now I realize that R is certainly super powerful tool to analyze and communicate stories with data!\n\nThe most challenging part of this project and the course in general, for me, was the need to learn a new programming language, having in mind what to do but the difficulty to find the \"language\" to create it in R was the most difficult part.\n\nLastly, in terms of next steps in this project, should be trying to confirm with specific statistics some of the hypothesis created here based on the exploration and visualization of the data.\n\nAlso, and assuming that I can have access to more data in this company, I would try to get key additional information like Gender, Salary, Department, Performance rating,  turnover, or engagement score if avaialble. In particular grouping data by department could be very interesting as sometimes the absence is a symptom of the work environment.\n\n\n## Bibliography\n\n\nDataset source: https://www.kaggle.com/datasets/tonypriyanka2913/employee-absenteeism\n\nPizam, A. & Thornburg, S. (2000). Absenteeism and voluntary turnover in Central Florida hotels: a pilot study. International Journal of Hospitality Management, Volume 19, Issue 2. https://doi.org/10.1016/S0278-4319(00)00011-6\n\n\nHenkerson, M. & Persson, M. (2004). The Effects on Sick Leave of Changes in the Sickness Insurance System. Journal of Labor Economics , Vol. 22, No. 1. https://www.jstor.org/stable/10.1086/380404\n\n\n\n",
    "supporting": [
      "FelixBetancourt_FinalProject601vFinal_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}